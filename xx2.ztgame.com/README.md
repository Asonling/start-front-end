<a href="http://win5do.cc/xx2" target="_blank"><h3 id="readme">炫酷的游戏专题页面</h3></a>

1. 简介

    仿写的某游戏的官网<a href="http://xx2.ztgame.com" target="_blank">xx2.ztgame.com</a>,看到这个网站的fullpage滚动，css3动画，视频弹出层，弹幕等都是当下比较热门的交互，并且有pc端和移动端。于是自己尝试写一下，用scss写的式样，根据自己的理解写的js逻辑，之原来的差别很大。

2. 技术栈

* pc端：jquery、scss、html5、css3
* 移动端：zepto、rem布局、zepto.fullpage插件

3. 主要功能

* 弹幕：第一屏可开启弹幕，弹幕有三种式样，四条轨道，随机生成，速度也是随机的，后一个弹幕不会与前一个弹幕式样和轨道重复。并且可以手动发送弹幕，控制弹幕的两个按钮可以随状态变化。
* 屏幕上的花瓣：跟随移动鼠标的花瓣，可以正向或反向移动。
* 时髦的fullpage效果：滚轮和点击导航都可以控制，pc端自己写的js，移动端尝试应用下插件，采用的zepto.fullpage插件。原网页使用的是swiper，事实证明swiper效果更生动，还能用在m端的轮播里面。
* css及jquery动画：页面中动画效果非常多。

4. 碰到和解决的问题

* 弹幕：开始看到原网站的弹幕感觉好困难，仔细研究了一番，也就随机式样，然后把设定好的弹幕数组填充进去，逻辑通了，分解成个小步实现起来也没有想象的那么难。
* 花瓣：开始想让花瓣移动的距离在一定范围内随机生成，但是mousemove频繁触发，花瓣抖的非常厉害，转整数也不行，只好用固定值了。
* 移动端滑动手势：移动端有个轮播，没用swiper插件只好自己写咯。以前没写过touch事件，网上查了一下，touchstart和touchend获取起始坐标，再来计算角度判断滑动方向，简易的实现了。手势与运动方向相反，切记。
* 网页首屏加载慢：做完放在线上后发现，首页的背景图加载超慢，经常白屏。在network里看到是因为后面的图片和视频阻塞了背景图加载，于是将首屏的背景图写成img放在html里，然后滚动到对应屏才开始加载弹出层的资源，便不再出现白屏过久了。
* 不能跨域ajax：原网站第一屏有个flash，把地址改一下链接是可以打开的，但是在我的页面上会卡住，下到本地也不行，第一屏就用了张图了，flash+弹幕也会非常卡。原网站新闻列表也是通过ajax请求的，我这边当然拿不到了，就用静态的代替了。

5. 总结

    看到这个网站挺时髦就来仿写了，想着简历也用这种全屏滚动的方式。以前没写过这么多js，光pc端就有四五百行，开始是从上到下的写法，才实现了一小部分就发现这么写代码太乱了，于是改成对象写法，相互调用的时候踩了很多this和作用域的坑，不得不重温下js红宝书。通过这个项目加深了自己对动画，事件，作用域的理解以及this的理解，对jq和css3的运用也更熟练了。但是即便是用了对象写法，而且注释也写得蛮多，但是fix bug的时候上下翻着看代码的时候还是感觉蛮蛋疼，很多地方要是封装成函数，通过传参、回调来调用，逻辑应该会更清晰了，解耦这方面还差很远。写过稍微复杂一点的项目才明白，模块化的必要性，webpack大法好！
